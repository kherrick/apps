import{b as X}from"./chunk-QNJTP72R.js";import{q as H}from"./chunk-DCYIHBUG.js";import{$b as A,Ab as N,Ac as T,Bb as z,Da as R,Ec as D,Jb as r,Kb as o,Lb as S,Mb as G,Rb as _,Sb as x,Va as C,_b as k,ba as p,fa as O,fc as s,ga as w,ha as E,ib as V,ka as j,la as P,ra as v}from"./chunk-5BYLU2DL.js";import{a as y,b}from"./chunk-DAQOROHW.js";function F(l,t,e,n){return`
    ${n}

    function setDeepGlobalValue(root, keys, value) {
      let obj = root;

      for (let i = 0; i < keys.length - 1; i++) {
        if (!obj[keys[i]]) {
          obj[keys[i]] = {};
        }

        obj = obj[keys[i]];
      }

      obj[keys[keys.length - 1]] = value;
    }

    setDeepGlobalValue(
      globalThis,
      [
        'spriteGarden',
        'refs',
        '${t}',
        '${e.replaceAll("/",",").replaceAll(",","','")}'
      ],
      ${l}
    );
  `}function U(l,t){let e=l;for(let n of t){if(!e)return;e=e[n]}return e}function I(l){return l.replaceAll("/",":")}var J=["spriteGarden"],Y=["spriteGardenInfo"];function K(l,t){if(l&1){let e=G();r(0,"sprite-garden",3,0),_("sprite-garden-load",function(i){w(e);let c=x();return E(c.handleSpriteGardenEvents(i))}),o()}}function ee(l,t){if(l&1){let e=G();r(0,"div",2,1)(2,"div",4)(3,"section")(4,"header")(5,"h1")(6,"a",5),s(7,"Sprite Garden"),o()()(),r(8,"section")(9,"img",6),_("click",function(i){w(e);let c=x();return E(c.handleLoad(i))})("keydown",function(i){w(e);let c=x();return E(c.handleLoad(i))}),o(),r(10,"h2")(11,"a",5),s(12,"Sprite Garden"),o(),s(13," is a 2D sandbox exploration and farming game. Learn more at the "),r(14,"a",7),s(15,"project page"),o(),s(16,". "),o(),r(17,"ul",8)(18,"li"),s(19,"Procedural World Generation - Explore uniquely generated maps"),o(),r(20,"li"),s(21," Multiple Biomes - Forests, deserts, tundras, and swamps, with their own characteristics "),o(),r(22,"li"),s(23," Farming System - Plant and harvest different crop types with various growth cycles "),o(),r(24,"li"),s(25,"Resource gathering - Dig for items like coal, iron, and gold"),o(),r(26,"li"),s(27," Cave Systems - Discover underground caves filled with resources and challenges "),o(),r(28,"li"),s(29,"Building - Use collected materials to place blocks and shape the world"),o(),r(30,"li"),s(31," Clouds - Continue building and farming while in the sky"),S(32,"br")(33,"br")(34,"iframe",9),o(),r(35,"li"),s(36," Discover - Open source, extendable by nature, map editor, color customization, etc."),S(37,"br")(38,"br")(39,"iframe",10),o()()()()()()}}var W=class l{doc=p(P);isLoading=v(!1);injector=p(j);resizeObserver;renderSpriteGarden=v(!1);themeService=p(X);platformId=p(R);canvasEl=v(null);spriteGarden=D("spriteGarden");spriteGardenInfo=D("spriteGardenInfo");fogMapModuleCommit="2314d3616959bb8877b9591adf600a9d3b573b09";fogMapModuleCommitPath="src/map/fog.mjs";fogMapModuleClassName="FogMap";async ngOnInit(){if(H(this.platformId)){await import("https://kherrick.github.io/sprite-garden/sprite-garden-bundle-min.mjs");let t=`https://raw.githubusercontent.com/kherrick/sprite-garden/${this.fogMapModuleCommit}/${this.fogMapModuleCommitPath}`,e=I(t);if(globalThis.document.getElementById(e))return;let n=await(await fetch(t)).text(),i=globalThis.document.createElement("script");i.setAttribute("type","module"),i.setAttribute("id",e),i.textContent=F(this.fogMapModuleClassName,this.fogMapModuleCommit,this.fogMapModuleCommitPath,n),globalThis.document.body.append(i)}}constructor(){O(this.injector,()=>{T(async()=>{let t=globalThis?.spriteGarden,e=this.themeService.theme(),n=t?.state,i=t?.config,c=i?.WORLD_WIDTH?.get(),g=i?.WORLD_HEIGHT?.get(),m;e==="dark"&&(m=b(y({},n?.exploredMap.get().colors),{"--sg-tile-fog-color":"#121212"})),e==="light"&&(m=b(y({},n?.exploredMap.get().colors),{"--sg-tile-fog-color":"#ffffff"}));let M=`spriteGarden/refs/${this.fogMapModuleCommit}/${this.fogMapModuleCommitPath}`,u=I(M),a=U(globalThis,u.split(":"))?.fromObject(b(y({},n?.exploredMap.get()),{colors:m}),c,g,m);n?.exploredMap.set(a)}),T(()=>{let t=this.canvasEl();t&&t.focus()})})}handleLoad(t){if(t.key&&t.key!==" "&&t.key!=="Enter")return;this.renderSpriteGarden.set(!0);let e=(d,a)=>{let h;return(...f)=>{clearTimeout(h),h=setTimeout(()=>d(...f),a)}},n=()=>{let d=(q,Q)=>{for(let[B,Z]of Object.entries(Q))q.style.setProperty(B,Z)},a={"--sg-ui-grid-corner-max-height":"calc(100dvh - 5rem)","--sg-ui-grid-height":"calc(100dvh - 6rem)","--sg-ui-grid-width":"calc(100vw - 2rem)","--sg-ui-host-height":"calc(100dvh - 5rem)","--sg-ui-host-overflow":"hidden","--sg-ui-host-width":"calc(100vw - 2rem)","--sg-ui-touch-controls-bottom":"2rem","--sg-ui-touch-controls-position":"absolute","--sg-ui-touch-controls-width":"100%"},h={"--sg-ui-grid-corner-max-height":"calc(100dvh - 5rem)","--sg-ui-grid-height":"calc(100dvh - 6rem)","--sg-ui-grid-width":"calc(100vw - 7rem)","--sg-ui-host-height":"calc(100dvh - 5rem)","--sg-ui-host-overflow":"hidden","--sg-ui-host-width":"calc(100vw - 7rem)","--sg-ui-touch-controls-bottom":"6rem","--sg-ui-touch-controls-position":"absolute","--sg-ui-touch-controls-width":"100%"},f=this.spriteGarden()?.nativeElement,$=globalThis.getComputedStyle(globalThis.document.body).width,L=Number($.slice(0,-2));L<859&&d(f,a),L>=859&&d(f,h)},i=e(()=>{n()},0);typeof ResizeObserver=="function"&&(this.resizeObserver=new ResizeObserver(()=>{i()}),this.resizeObserver.observe(this.doc.body));let c=1e4,g=20,m=0,M=d=>{let a=this.doc.createElement("canvas");return a.width=d.width,a.height=d.height,d.toDataURL()===a.toDataURL()},u=()=>{let a=this.spriteGarden()?.nativeElement?.shadowRoot?.querySelector("canvas");if(a&&!M(a)){this.canvasEl.set(a);return}m<c&&(m+=g,setTimeout(u,g))};u()}handleSpriteGardenEvents(t){let e=this.spriteGarden()?.nativeElement,n=!!t?.detail?.isLoading;this.isLoading.set(n);let i=this.doc.querySelector(".progress");i&&(i.style.display=n?"none":"unset",e&&setTimeout(()=>{i.style.display="none",e.style.display="flex"},0))}ngOnDestroy(){this.resizeObserver?.unobserve(this.doc.body);let t=this.doc.querySelector(".progress");t&&(t.style.display="none")}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=V({type:l,selectors:[["x-sprite-garden"]],viewQuery:function(e,n){e&1&&(k(n.spriteGarden,J,5),k(n.spriteGardenInfo,Y,5)),e&2&&A(2)},decls:2,vars:1,consts:[["spriteGarden",""],["spriteGardenInfo",""],["sprite-garden-container",""],[3,"sprite-garden-load"],["sprite-garden",""],["href","https://kherrick.github.io/sprite-garden/"],["src","assets/images/sprite-garden-launcher.png","tabindex","0",1,"launcher",3,"click","keydown"],["href","https://github.com/kherrick/sprite-garden"],[1,"features"],["allowfullscreen","","frameborder","0","src",C`//www.youtube.com/embed/Es60fVIyOjY`],["allowfullscreen","","frameborder","0","src",C`//www.youtube.com/embed/VQbZTvWGXM4`]],template:function(e,n){e&1&&N(0,K,2,0,"sprite-garden")(1,ee,40,0,"div",2),e&2&&z(n.renderSpriteGarden()?0:1)},styles:[`@font-face{font-family:Material Icons;font-style:normal;font-weight:400;font-display:block;src:url(https://fonts.gstatic.com/s/materialicons/v145/flUhRq6tzZclQEJ-Vdg-IuiaDsNc.woff2) format("woff2")}.material-icons{font-family:Material Icons;font-weight:400;font-style:normal;font-size:24px;line-height:1;letter-spacing:normal;text-transform:none;display:inline-block;white-space:nowrap;word-wrap:normal;direction:ltr;-webkit-font-feature-settings:"liga";-webkit-font-smoothing:antialiased}:host{--md-outlined-text-field-container-shape: 1rem;--md-outlined-button-container-shape: 1rem;--md-outlined-button-disabled-label-text-color: var(--md-sys-color-on-surface)}.launcher{cursor:pointer}.features>li{padding-bottom:.5rem}[sprite-garden-container]{align-items:center;color:var(--md-sys-color-on-surface);display:flex;flex-direction:row;flex-wrap:wrap;grid-column-gap:1rem;grid-row-gap:1rem;justify-content:center;text-align:center}[sprite-garden-container] a{color:var(--md-sys-color-on-surface);text-decoration:underline}[sprite-garden-container] [sprite-garden]{max-width:35rem;text-align:center;display:flex;justify-content:center}[sprite-garden-container] [sprite-garden] iframe{height:auto;min-height:17.5625rem;width:100%}[sprite-garden-container] [sprite-garden] img{width:calc(100% - 2rem)}[sprite-garden-container] [sprite-garden] p{padding:0 1rem}[sprite-garden-container] [sprite-garden] ul{padding:0 3rem;text-align:left}sprite-garden{--sg-color-black: #121212;--sg-tile-fog-color: var(--x-shell-background-color);display:none}
`],encapsulation:3})};export{W as XSpriteGardenComponent};
